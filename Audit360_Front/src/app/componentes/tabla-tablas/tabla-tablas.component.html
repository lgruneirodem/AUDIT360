<!-- Caja de filtros mejorada -->
<ion-card class="header-card">
  <ion-card-content>
    <h1 class="title">Administración de Tablas</h1>
    <p class="breadcrumb">Base de datos > Tablas > Gestión</p>

    <div class="connection-status">
      <ion-icon name="ellipse" color="success" style="font-size: 8px;"></ion-icon>
      <span class="status-text">Conectado a la base de datos</span>
    </div>
  </ion-card-content>
</ion-card>

<!-- Barra de acciones -->
<ion-toolbar class="action-toolbar" >
  <ion-buttons slot="start" class="action-buttons">
    <ion-button color="primary" fill="solid">
      Nueva Tabla
    </ion-button>

    <ion-button fill="outline" color="medium">
      Sincronizar Schema
    </ion-button>

    <ion-button color="warning" fill="solid">
      Respaldar Tablas
    </ion-button>
  </ion-buttons>

  <ion-searchbar
    placeholder="Buscar tablas..."
    slot="start"
    class="custom-searchbar">
  </ion-searchbar>
</ion-toolbar>

<!-- Resultados y estadísticas -->
<div class="results-summary" *ngIf="tablaFiltrada.length > 0">
  <ion-chip color="primary" class="result-chip">
    <ion-icon name="list-outline"></ion-icon>
    <ion-label>{{ tablaFiltrada.length }} tabla(s) encontrada(s)</ion-label>
  </ion-chip>
</div>

<!-- Tabla de resultados mejorada -->
<div class="table-container">
  <ion-card class="table-card">
    <ion-card-content class="table-content">
      <!-- Tabla para desktop -->
      <div class="desktop-table" *ngIf="!isMobile">
        <ion-grid class="table-grid">
          <ion-row class="table-header">
            <ion-col size="2">
              <strong>Tabla</strong>
            </ion-col>
            <ion-col size="1.5">
              <strong>Registros</strong>
            </ion-col>
            <ion-col size="1.5">
              <strong>Estado</strong>
            </ion-col>
            <ion-col size="2">
              <strong>Última Operación</strong>
            </ion-col>
            <ion-col size="2">
              <strong>Alertas</strong>
            </ion-col>
            <ion-col size="3">
              <strong>Acciones</strong>
            </ion-col>
          </ion-row>
          
          <ion-row 
            *ngFor="let table of tablaFiltrada; let i = index" 
            class="table-row"
            [class.even-row]="i % 2 === 0">
            
            <ion-col size="2" class="table-name">
              <div class="name-container">
                <ion-icon name="table-outline" class="table-icon"></ion-icon>
                <div>
                  <strong>{{ table.name }}</strong>
                  <p class="schema-name">{{ table.schema }}</p>
                </div>
              </div>
            </ion-col>
            
            <ion-col size="1.5" class="records-count">
              <span class="number-badge">{{ table.rows | number }}</span>
            </ion-col>
            
            <ion-col size="1.5">
              <ion-badge 
                class="status-badge"
                [color]="getStatusColor(table.status)">
                {{ table.status }}
              </ion-badge>
            </ion-col>
            
            <ion-col size="2" class="last-operation">
              <div class="operation-info">
                <span class="operation-type">{{ table.lastOp }}</span>
                <span class="operation-time">{{ table.lastOpTime | date:'short' }}</span>
              </div>
            </ion-col>
            
            <ion-col size="2" class="alerts-column">
              <div *ngIf="table.alerta" class="alert-container">
                <ion-icon name="warning-outline" class="alert-icon"></ion-icon>
                <span class="alert-text">{{ table.alerta }}</span>
              </div>
              <span *ngIf="!table.alerta" class="no-alerts">Sin alertas</span>
            </ion-col>
            
            <ion-col size="3" class="actions-column">
              <div class="action-buttons-container">
                <ion-button 
                  size="small" 
                  fill="outline" 
                  color="primary"
                  (click)="configurarTabla(table)"
                  class="action-btn">
                  <ion-icon name="settings-outline" slot="icon-only"></ion-icon>
                </ion-button>
                
                <ion-button 
                  size="small" 
                  fill="outline" 
                  color="secondary"
                  (click)="verHistorial(table)"
                  class="action-btn">
                  <ion-icon name="time-outline" slot="icon-only"></ion-icon>
                </ion-button>
                
                <ion-button 
                  size="small" 
                  fill="outline" 
                  color="success"
                  (click)="verDatos(table)"
                  class="action-btn">
                  <ion-icon name="eye-outline" slot="icon-only"></ion-icon>
                </ion-button>
                
                <ion-button 
                  size="small" 
                  fill="clear" 
                  color="medium"
                  (click)="mostrarMasAcciones(table)"
                  class="more-actions-btn">
                  <ion-icon name="ellipsis-vertical" slot="icon-only"></ion-icon>
                </ion-button>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
      </div>
      
      <!-- Cards para móvil -->
      <div class="mobile-cards" *ngIf="isMobile">
        <ion-card 
          *ngFor="let table of tablaFiltrada" 
          class="mobile-table-card"
          (click)="verDetalleTabla(table)">
          
          <ion-card-header>
            <div class="mobile-card-header">
              <div class="table-info">
                <ion-card-title>{{ table.name }}</ion-card-title>
                <ion-card-subtitle>{{ table.schema }}</ion-card-subtitle>
              </div>
              <ion-badge 
                [color]="getStatusColor(table.status)"
                class="mobile-status-badge">
                {{ table.status }}
              </ion-badge>
            </div>
          </ion-card-header>
          
          <ion-card-content>
            <div class="mobile-card-content">
              <div class="info-row">
                <span class="label">Registros:</span>
                <span class="value">{{ table.rows | number }}</span>
              </div>
              
              <div class="info-row">
                <span class="label">Última Op:</span>
                <span class="value">{{ table.lastOp }}</span>
              </div>
              
              <div class="info-row" *ngIf="table.alerta">
                <span class="label">Alerta:</span>
                <span class="value alert-value">
                  <ion-icon name="warning-outline"></ion-icon>
                  {{ table.alerta }}
                </span>
              </div>
            </div>
            
            <div class="mobile-actions">
              <ion-button size="small" fill="outline" (click)="configurarTabla(table); $event.stopPropagation()">
                Configurar
              </ion-button>
              <ion-button size="small" fill="clear" (click)="verHistorial(table); $event.stopPropagation()">
                Historial
              </ion-button>
            </div>
          </ion-card-content>
        </ion-card>
      </div>
      
      <!-- Estado vacío -->
      <div *ngIf="tablaFiltrada.length === 0" class="empty-state">
        <ion-icon name="search-outline" class="empty-icon"></ion-icon>
        <h3>No se encontraron resultados</h3>
        <p>Intenta ajustar los filtros de búsqueda</p>
        <ion-button fill="outline" (click)="limpiarFiltros()">
          Limpiar filtros
        </ion-button>
      </div>
    </ion-card-content>
  </ion-card>
</div>